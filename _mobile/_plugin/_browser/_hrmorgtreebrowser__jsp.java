/*
 * JSP generated by Resin-3.1.8 (built Mon, 17 Nov 2008 12:15:21 PST)
 */

package _jsp._mobile._plugin._browser;
import javax.servlet.*;
import javax.servlet.jsp.*;
import javax.servlet.http.*;
import java.util.List;
import java.util.ArrayList;
import weaver.general.Util;
import weaver.hrm.company.SubCompanyComInfo;
import weaver.hrm.company.CompanyTreeNode;
import weaver.hrm.User;
import java.util.Iterator;
import weaver.systeminfo.SystemEnv;
import weaver.hrm.*;
import weaver.file.FileUpload;

public class _hrmorgtreebrowser__jsp extends com.caucho.jsp.JavaPage
{
  private static final java.util.HashMap<String,java.lang.reflect.Method> _jsp_functionMap = new java.util.HashMap<String,java.lang.reflect.Method>();
  private boolean _caucho_isDead;
  
  public void
  _jspService(javax.servlet.http.HttpServletRequest request,
              javax.servlet.http.HttpServletResponse response)
    throws java.io.IOException, javax.servlet.ServletException
  {
    javax.servlet.http.HttpSession session = request.getSession(true);
    com.caucho.server.webapp.WebApp _jsp_application = _caucho_getApplication();
    javax.servlet.ServletContext application = _jsp_application;
    com.caucho.jsp.PageContextImpl pageContext = _jsp_application.getJspApplicationContext().allocatePageContext(this, _jsp_application, request, response, null, session, 8192, true, false);
    javax.servlet.jsp.PageContext _jsp_parentContext = pageContext;
    javax.servlet.jsp.JspWriter out = pageContext.getOut();
    final javax.el.ELContext _jsp_env = pageContext.getELContext();
    javax.servlet.ServletConfig config = getServletConfig();
    javax.servlet.Servlet page = this;
    response.setContentType("text/html; charset=UTF-8");
    request.setCharacterEncoding("UTF-8");
    try {
      out.write(_jsp_string0, 0, _jsp_string0.length);
      weaver.conn.RecordSet RecordSet;
      RecordSet = (weaver.conn.RecordSet) pageContext.getAttribute("RecordSet");
      if (RecordSet == null) {
        RecordSet = new weaver.conn.RecordSet();
        pageContext.setAttribute("RecordSet", RecordSet);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.hrm.company.SubCompanyComInfo SubCompanyComInfo;
      SubCompanyComInfo = (weaver.hrm.company.SubCompanyComInfo) pageContext.getAttribute("SubCompanyComInfo");
      if (SubCompanyComInfo == null) {
        SubCompanyComInfo = new weaver.hrm.company.SubCompanyComInfo();
        pageContext.setAttribute("SubCompanyComInfo", SubCompanyComInfo);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.hrm.company.CompanyComInfo CompanyComInfo;
      CompanyComInfo = (weaver.hrm.company.CompanyComInfo) pageContext.getAttribute("CompanyComInfo");
      if (CompanyComInfo == null) {
        CompanyComInfo = new weaver.hrm.company.CompanyComInfo();
        pageContext.setAttribute("CompanyComInfo", CompanyComInfo);
      }
      out.write(_jsp_string1, 0, _jsp_string1.length);
      weaver.hrm.company.DepartmentComInfo DepartmentComInfo;
      DepartmentComInfo = (weaver.hrm.company.DepartmentComInfo) pageContext.getAttribute("DepartmentComInfo");
      if (DepartmentComInfo == null) {
        DepartmentComInfo = new weaver.hrm.company.DepartmentComInfo();
        pageContext.setAttribute("DepartmentComInfo", DepartmentComInfo);
      }
      out.write(_jsp_string2, 0, _jsp_string2.length);
      
FileUpload fu = new FileUpload(request);
request.setCharacterEncoding("UTF-8");
response.setContentType("text/html;charset=UTF-8");
  
  User user = HrmUserVarify.getUser(request , response);
  if(user==null){
	  out.println("\u767b\u9646\u8d85\u65f6,\u8bf7\u91cd\u65b0\u767b\u9646!");
	  return ;
  }

      out.write(_jsp_string3, 0, _jsp_string3.length);
      
String browserType=Util.null2String(request.getParameter("browserType"));   //\u6d4f\u89c8\u6846\u7c7b\u578b
String type=Util.null2String(request.getParameter("type"));
String id=Util.null2String(request.getParameter("id"));
String excludeid=Util.null2String(request.getParameter("excludeid"));
String nodename=Util.null2String(request.getParameter("nodename"));
String level=Util.null2String(request.getParameter("level"));
String subid=Util.null2String(request.getParameter("subid"));
String selectedDepartmentIds = Util.null2String(request.getParameter("selectedDepartmentIds"));
String passedDepartmentIds = Util.null2String(request.getParameter("passedDepartmentIds"));
String sqlwhere = Util.null2String(request.getParameter("sqlwhere"));
String selectedids = Util.null2String(request.getParameter("selectedids"));  //\u4f20\u9012\u8fc7\u6765\u7684id
//selectedids=",56,54,47";
//selectedids=",27,22";

String selectnode ="";
String supcompanyid = "";

String[] selecteds = selectedids.split("[,]");
int deptlevel = 0;
int maxnum=0;

if(browserType.equals("departmentMulti")){        //\u9009\u4e2d\u5df2\u7ecf\u9009\u62e9\u7684\u90e8\u95e8
	if(!"".equals(selectedids)&&!"0".equals(selectedids)){
		for(int i=0;i<selecteds.length;i++){
			if(!"".equals(selecteds[i])&&!"0".equals(selecteds[i])){
				maxnum = DepartmentComInfo.getLevelByDepId(selecteds[i]);
				if(deptlevel<maxnum){
					deptlevel = maxnum;
				}
			}
		}
	}
	
	if(!"".equals(selectedids)&&!"0".equals(selectedids)){
		for(int i=0;i<selecteds.length;i++){
			if(!"".equals(selecteds[i])&&!"0".equals(selecteds[i])){
				supcompanyid = DepartmentComInfo.getSubcompanyid1(selecteds[i]);
				selectnode = ",dept_"+supcompanyid+"_"+selecteds[i]+selectnode;
			}
		}
	}
}else if(browserType.equals("subcompanyMuti")){  //\u9009\u4e2d\u5df2\u7ecf\u9009\u62e9\u7684\u5206\u90e8
	if(!"".equals(selectedids)&&!"0".equals(selectedids)){
	for(int i=0;i<selecteds.length;i++){
		if(!"".equals(selecteds[i])&&!"0".equals(selecteds[i])){
			selectnode = ",com_"+selecteds[i]+selectnode;
		}
	}
    }
}


if(selectnode.startsWith(",")){
	selectnode = selectnode.substring(1);
}

String nodeid=null;
Cookie[] cks= request.getCookies();
String rem=null;

if(rem!=null&&rem.length()>0)
nodeid=rem;
boolean exist=false;
if(nodeid!=null&&nodeid.indexOf("dept")>-1){
    String deptname=DepartmentComInfo.getDepartmentname(nodeid.substring(nodeid.lastIndexOf("_")+1));
    String subcom=DepartmentComInfo.getSubcompanyid1(nodeid.substring(nodeid.lastIndexOf("_")+1));
    if(!deptname.equals("")&&subcom.equals(nodeid.substring(nodeid.indexOf("_")+1,nodeid.lastIndexOf("_")))&&!nodeid.substring(nodeid.lastIndexOf("_")+1).equals(excludeid))
        exist=true;
        if(!excludeid.equals("")){

            String idInCookie=nodeid.substring(nodeid.lastIndexOf("_")+1);
           //System.out.println("excludeid="+excludeid);
            List l=new ArrayList();
            SubCompanyComInfo.getDepartTreeList(l,subcom,excludeid,0,999,"",null,null);
            //System.out.println(l.size());
            for(Iterator iter=l.iterator();iter.hasNext();){
                   CompanyTreeNode node=(CompanyTreeNode)iter.next() ;
                //System.out.println("nodeid="+node.getId());
                   if(node.getType().equals("dept")&&node.getId().equals(idInCookie)){
                       exist=false;
                       break;
                   }
            }

        }

}
if(!exist)
nodeid=null;


      out.write(_jsp_string4, 0, _jsp_string4.length);
      out.print((type));
      out.write(_jsp_string5, 0, _jsp_string5.length);
      out.print((id));
      out.write(_jsp_string6, 0, _jsp_string6.length);
      out.print((level));
      out.write(_jsp_string7, 0, _jsp_string7.length);
      out.print((subid));
      out.write(_jsp_string8, 0, _jsp_string8.length);
      out.print((nodename));
      out.write(_jsp_string9, 0, _jsp_string9.length);
      out.print((browserType.equals("resourceMulti")?250:420));
      out.write(_jsp_string10, 0, _jsp_string10.length);
      if(!browserType.equals("resourceMulti")){
      out.write(_jsp_string11, 0, _jsp_string11.length);
      out.print((SystemEnv.getHtmlLabelName(826,user.getLanguage())));
      out.write(_jsp_string12, 0, _jsp_string12.length);
      out.print((SystemEnv.getHtmlLabelName(311,user.getLanguage())));
      out.write(_jsp_string13, 0, _jsp_string13.length);
      out.print((SystemEnv.getHtmlLabelName(201,user.getLanguage())));
      out.write(_jsp_string14, 0, _jsp_string14.length);
      if(browserType=="departmentMulti"||browserType=="subcompanyMuti"){ 
      out.write(_jsp_string15, 0, _jsp_string15.length);
      }
      out.write(_jsp_string16, 0, _jsp_string16.length);
      } 
      out.write(_jsp_string17, 0, _jsp_string17.length);
      out.print((browserType));
      out.write(_jsp_string18, 0, _jsp_string18.length);
      out.print((selectedids));
      out.write(_jsp_string19, 0, _jsp_string19.length);
      out.print((selectnode));
      out.write(_jsp_string20, 0, _jsp_string20.length);
      out.print((selectnode));
      out.write(_jsp_string21, 0, _jsp_string21.length);
      out.print((deptlevel));
      out.write(_jsp_string22, 0, _jsp_string22.length);
      out.print((excludeid));
      if(nodeid!=null){
      out.write(_jsp_string23, 0, _jsp_string23.length);
      out.print((nodeid));
      }
      out.write(_jsp_string24, 0, _jsp_string24.length);
      out.print((SystemEnv.getHtmlLabelName(19324,user.getLanguage())));
      out.write(_jsp_string25, 0, _jsp_string25.length);
      out.print((SystemEnv.getHtmlLabelName(19323,user.getLanguage())));
      out.write(_jsp_string26, 0, _jsp_string26.length);
    } catch (java.lang.Throwable _jsp_e) {
      pageContext.handlePageException(_jsp_e);
    } finally {
      _jsp_application.getJspApplicationContext().freePageContext(pageContext);
    }
  }

  private java.util.ArrayList _caucho_depends = new java.util.ArrayList();

  public java.util.ArrayList _caucho_getDependList()
  {
    return _caucho_depends;
  }

  public void _caucho_addDepend(com.caucho.vfs.PersistentDependency depend)
  {
    super._caucho_addDepend(depend);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
  }

  public boolean _caucho_isModified()
  {
    if (_caucho_isDead)
      return true;
    if (com.caucho.server.util.CauchoSystem.getVersionId() != 1886798272571451039L)
      return true;
    for (int i = _caucho_depends.size() - 1; i >= 0; i--) {
      com.caucho.vfs.Dependency depend;
      depend = (com.caucho.vfs.Dependency) _caucho_depends.get(i);
      if (depend.isModified())
        return true;
    }
    return false;
  }

  public long _caucho_lastModified()
  {
    return 0;
  }

  public java.util.HashMap<String,java.lang.reflect.Method> _caucho_getFunctionMap()
  {
    return _jsp_functionMap;
  }

  public void init(ServletConfig config)
    throws ServletException
  {
    com.caucho.server.webapp.WebApp webApp
      = (com.caucho.server.webapp.WebApp) config.getServletContext();
    super.init(config);
    com.caucho.jsp.TaglibManager manager = webApp.getJspApplicationContext().getTaglibManager();
    com.caucho.jsp.PageContextImpl pageContext = new com.caucho.jsp.PageContextImpl(webApp, this);
  }

  public void destroy()
  {
      _caucho_isDead = true;
      super.destroy();
  }

  public void init(com.caucho.vfs.Path appDir)
    throws javax.servlet.ServletException
  {
    com.caucho.vfs.Path resinHome = com.caucho.server.util.CauchoSystem.getResinHome();
    com.caucho.vfs.MergePath mergePath = new com.caucho.vfs.MergePath();
    mergePath.addMergePath(appDir);
    mergePath.addMergePath(resinHome);
    com.caucho.loader.DynamicClassLoader loader;
    loader = (com.caucho.loader.DynamicClassLoader) getClass().getClassLoader();
    String resourcePath = loader.getResourcePathSpecificFirst();
    mergePath.addClassPath(resourcePath);
    com.caucho.vfs.Depend depend;
    depend = new com.caucho.vfs.Depend(appDir.lookup("mobile/plugin/browser/HrmOrgTreeBrowser.jsp"), 8992524966322748143L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
    depend = new com.caucho.vfs.Depend(appDir.lookup("mobile/plugin/browser/MobileInit.jsp"), 1397717249655627205L, false);
    com.caucho.jsp.JavaPage.addDepend(_caucho_depends, depend);
  }

  private final static char []_jsp_string7;
  private final static char []_jsp_string24;
  private final static char []_jsp_string16;
  private final static char []_jsp_string23;
  private final static char []_jsp_string13;
  private final static char []_jsp_string10;
  private final static char []_jsp_string25;
  private final static char []_jsp_string8;
  private final static char []_jsp_string26;
  private final static char []_jsp_string9;
  private final static char []_jsp_string21;
  private final static char []_jsp_string0;
  private final static char []_jsp_string18;
  private final static char []_jsp_string20;
  private final static char []_jsp_string22;
  private final static char []_jsp_string5;
  private final static char []_jsp_string6;
  private final static char []_jsp_string3;
  private final static char []_jsp_string11;
  private final static char []_jsp_string4;
  private final static char []_jsp_string2;
  private final static char []_jsp_string1;
  private final static char []_jsp_string12;
  private final static char []_jsp_string19;
  private final static char []_jsp_string17;
  private final static char []_jsp_string14;
  private final static char []_jsp_string15;
  static {
    _jsp_string7 = "\">\r\n    <input class=inputstyle type=hidden name=subid value=\"".toCharArray();
    _jsp_string24 = "&browserType=\"+browserType+ \"&\" + new Date().getTime() + \"=\" + new Date().getTime();\r\n	    }\r\n	};\r\n	//zTree\u914d\u7f6e\u4fe1\u606f\r\n	var setting;\r\n	if(browserType==\"departmentSingle\"||browserType==\"subcompanySingle\"){\r\n	   setting = {\r\n		async: {\r\n			enable: true,       //\u542f\u7528\u5f02\u6b65\u52a0\u8f7d\r\n			type:\"get\",\r\n			dataType: \"text\",   //ajax\u6570\u636e\u7c7b\u578b\r\n			url: getAsyncUrl    //ajax\u7684url\r\n		},\r\n		check: {\r\n			enable: true,       //\u542f\u7528checkbox\u6216\u8005radio\r\n			chkStyle: \"radio\",  //check\u7c7b\u578b\u4e3aradio\r\n			radioType: \"all\",   //radio\u9009\u62e9\u8303\u56f4\r\n			chkboxType: { \"Y\" : \"\", \"N\" : \"\" } \r\n		},\r\n		view: {\r\n			expandSpeed: \"\"     //\u6548\u679c\r\n		},\r\n		callback: {\r\n			onClick: zTreeOnClick,   //\u8282\u70b9\u70b9\u51fb\u4e8b\u4ef6\r\n			onAsyncSuccess: zTreeOnAsyncSuccess  //ajax\u6210\u529f\u4e8b\u4ef6\r\n		}\r\n	};\r\n	}else if(browserType==\"departmentMulti\"||browserType==\"subcompanyMuti\"){\r\n		setting = {\r\n			async: {\r\n				enable: true,       //\u542f\u7528\u5f02\u6b65\u52a0\u8f7d\r\n				type:\"get\",\r\n				dataType: \"text\",   //ajax\u6570\u636e\u7c7b\u578b\r\n				url: getAsyncUrl    //ajax\u7684url\r\n			},\r\n			check: {\r\n				enable: true,       //\u542f\u7528checkbox\u6216\u8005radio\r\n				chkStyle: \"checkbox\",  //check\u7c7b\u578b\u4e3acheckbox\r\n				chkboxType: { \"Y\" : \"\", \"N\" : \"\" } \r\n			},\r\n			view: {\r\n				expandSpeed: \"\"     //\u6548\u679c\r\n			},\r\n			callback: {\r\n				onClick: zTreeOnClick,   //\u8282\u70b9\u70b9\u51fb\u4e8b\u4ef6\r\n				onCheck: zTreeOnCheck,\r\n				onAsyncSuccess: zTreeOnAsyncSuccess  //ajax\u6210\u529f\u4e8b\u4ef6\r\n			}\r\n		};\r\n    }else if(browserType==\"resourceMulti\"){\r\n	    setting = {\r\n			async: {\r\n				enable: true,       //\u542f\u7528\u5f02\u6b65\u52a0\u8f7d\r\n				type:\"get\",\r\n				dataType: \"text\",   //ajax\u6570\u636e\u7c7b\u578b\r\n				url: getAsyncUrl    //ajax\u7684url\r\n			},\r\n			view: {\r\n				expandSpeed: \"\"     //\u6548\u679c\r\n			},\r\n			callback: {\r\n				onClick: zTreeOnClick,   //\u8282\u70b9\u70b9\u51fb\u4e8b\u4ef6\r\n				onCheck: zTreeOnCheck,\r\n				onAsyncSuccess: zTreeOnAsyncSuccess  //ajax\u6210\u529f\u4e8b\u4ef6\r\n			}\r\n		};\r\n	}\r\n	var zNodes =[];\r\n	\r\n	$(document).ready(function(){\r\n		//\u521d\u59cb\u5316zTree\r\n		$.fn.zTree.init($(\"#ztreedeep\"), setting, zNodes);\r\n	});\r\n	\r\n	function zTreeOnClick(event, treeId, treeNode) {\r\n	    var nodeid=treeNode.nodeid;\r\n	    var treeObj = $.fn.zTree.getZTreeObj(treeId);\r\n	    if (treeNode.isParent) {\r\n			treeObj.expandNode(treeNode);\r\n		}\r\n		treeObj.checkNode(treeNode, true, false);\r\n		\r\n		if(browserType==\"resourceMulti\"){\r\n		   jQuery(\"#frame2\",window.parent.document)[0].contentWindow.setResourceStr();\r\n		   var resourceids=jQuery(\"#frame2\",window.parent.document)[0].contentWindow.resourceids;\r\n		   if(nodeid.indexOf(\"dept\")!=-1){\r\n		      var nodeids=nodeid.split(\"_\");\r\n		      var subcompanyid=nodeids[1];\r\n		      var departmentid=nodeids[2];\r\n		      jQuery(window.parent.document).find(\"#frame2\").attr(\"src\",\"/mobile/plugin/browser/MutiResourceSelect.jsp?subcompanyid=\"+subcompanyid+\"&departmentid=\"+departmentid+\"&nodeid=\"+nodeid+\"&resourceids=\"+resourceids);\r\n		   }else if(nodeid.indexOf(\"com\")!=-1){\r\n		       var nodeids=nodeid.split(\"_\");\r\n		       var subcompanyid=nodeids[1];\r\n		       jQuery(window.parent.document).find(\"#frame2\").attr(\"src\",\"/mobile/plugin/browser/MutiResourceSelect.jsp?subcompanyid=\"+subcompanyid+\"&nodeid=\"+nodeid+\"&resourceids=\"+resourceids);\r\n		   }\r\n		}\r\n	};\r\n	\r\n	function onSave() {\r\n    	var  trunStr = \"\", returnVBArray = null;\r\n    	if(browserType==\"departmentSingle\"||browserType==\"subcompanySingle\")      //\u5206\u90e8\u3001\u90e8\u95e8\u5355\u9009\r\n	       trunStr =getSingleResult(); \r\n	    else if(browserType==\"departmentMulti\"||browserType==\"subcompanyMuti\")    //\u5206\u90e8\u3001\u90e8\u95e8\u591a\u9009\r\n	       trunStr=getMultiResult();\r\n	    \r\n	    if(trunStr != \"\") {\r\n			returnVBArray = trunStr.split(\"$\");\r\n			var returnjson = {id:returnVBArray[0],name:returnVBArray[1]};\r\n			/*\r\n			if (window.opener != undefined) {\r\n			       window.opener.returnValue =returnjson;\r\n			}else {\r\n			       window.returnValue =returnjson;\r\n			}\r\n			*/\r\n	        window.returnValue  = returnjson;\r\n	        window.close();\r\n	    } else {\r\n	        window.close();     \r\n		}\r\n    }\r\n    \r\n    function onClear() {\r\n	    window.parent.returnValue = {id:\"\",name:\"\"};\r\n	    window.parent.close();\r\n	}\r\n	\r\n	/**\r\n	 * checkbox\u9009\u4e2d\u65f6\u89e6\u53d1\r\n	 */\r\n	function zTreeOnCheck(event, treeId, treeNode) {\r\n		var treeObj = $.fn.zTree.getZTreeObj(treeId);\r\n		if (treeNode.isInitAttr == false) {\r\n			return;\r\n		}\r\n		\r\n		var nodes = treeNode.childs;\r\n		if (nodes == null || nodes == undefined) {\r\n			treeObj.reAsyncChildNodes(treeNode, \"refresh\");\r\n		}\r\n	}\r\n	\r\n	/**\r\n	 * ajax\u6210\u529f\u540e\u89e6\u53d1\r\n	 */\r\n	function zTreeOnAsyncSuccess(event, treeId, treeNode, msg) {\r\n	    var treeObj = $.fn.zTree.getZTreeObj(treeId);\r\n	    if(browserType==\"subcompanyMuti\")\r\n	       appendimg=\"Home\";\r\n	    \r\n		if (!selectallflag) {\r\n			var rootnodes = treeObj.getNodesByParamFuzzy(\"icon\", \"global\", null);\r\n			setIsExistsCheckbox(treeObj, rootnodes, true);\r\n			if(browserType!=\"subcompanySingle\"){\r\n				var homenodes = treeObj.getNodesByParamFuzzy(\"icon\", \"Home\", null);\r\n				var nodes = treeObj.getNodesByParamFuzzy(\"icon\", appendimg, null);\r\n				setIsExistsCheckbox(treeObj, homenodes, true);\r\n				setIsExistsCheckbox(treeObj, nodes, false);\r\n			}\r\n		} else {\r\n			if (treeNode != undefined && treeNode != null) {\r\n			    if (treeNode.checked) {\r\n				    var childrenNodes = treeNode.childs;\r\n			    	for (var i=0; i<childrenNodes.length; i++) {\r\n			    		childrenNodes[i].isInitAttr = false;\r\n						treeObj.updateNode(childrenNodes[i]);\r\n			    		treeObj.checkNode(childrenNodes[i], true, true);\r\n					}\r\n			    }\r\n		    }\r\n		}\r\n\r\n		var node = null;\r\n		if (cxtree_ids != undefined && cxtree_ids != null) {\r\n		    for (var z=0; z<cxtree_ids.length; z++) {\r\n				node = treeObj.getNodeByParam(\"id\", cxtree_ids[z], null);\r\n			    if (node != undefined && node != null ) {\r\n			    	treeObj.selectNode(node);\r\n			    	treeObj.checkNode(node, true, false);\r\n			    }\r\n		    }\r\n		}\r\n	}\r\n	\r\n	/**\r\n	 * \u5f00\u542f\u5173\u95ed\u5168\u9009\r\n	 */\r\n	function needSelectAll(flag, obj){\r\n		selectallflag = flag;\r\n	   \r\n	   	var treeObj = $.fn.zTree.getZTreeObj(\"ztreedeep\");\r\n	   	var type = { \"Y\":\"\", \"N\": \"\"};\r\n	   	if(selectallflag){\r\n	   		type = { \"Y\":\"s\", \"N\": \"s\"};\r\n	   	}\r\n	   	treeObj.setting.check.chkboxType = type;\r\n\r\n	   	if (!selectallflag) {\r\n			var rootnodes = treeObj.getNodesByParamFuzzy(\"icon\", \"global\", null);\r\n			var homenodes = treeObj.getNodesByParamFuzzy(\"icon\", \"Home\", null);\r\n			var nodes = treeObj.getNodesByParamFuzzy(\"icon\", appendimg, null);\r\n			setIsExistsCheckbox(treeObj, rootnodes, true);\r\n			setIsExistsCheckbox(treeObj, homenodes, true);\r\n			setIsExistsCheckbox(treeObj, nodes, false);\r\n		} else {\r\n			var nodes = treeObj.getNodesByParamFuzzy(\"icon\", \"images\", null);\r\n			setIsExistsCheckbox(treeObj, nodes, false);\r\n		}\r\n\r\n	   	var i = $(obj).html().indexOf('>');\r\n	   	if(selectallflag){\r\n	        a = $(obj).html().substring(0,i+1)+' ".toCharArray();
    _jsp_string16 = "\r\n										        </td>\r\n									        </tr>\r\n								        ".toCharArray();
    _jsp_string23 = "&init=true&nodeid=".toCharArray();
    _jsp_string13 = "</BUTTON>\r\n											        <BUTTON type=\"button\" class=btnReset accessKey=T  id=btncancel onclick=\"window.parent.close()\"><u>T</u>-".toCharArray();
    _jsp_string10 = "px;width:100%;overflow:scroll;\">\r\n	                                            	<ul id=\"ztreedeep\" class=\"ztree\"></ul>\r\n	                                            </div>\r\n                                          </TD>\r\n                                      </TR>\r\n                                      ".toCharArray();
    _jsp_string25 = "';\r\n	    } else{\r\n	    	a = $(obj).html().substring(0,i+1)+' ".toCharArray();
    _jsp_string8 = "\">\r\n    <input class=inputstyle type=hidden name=nodename value=\"".toCharArray();
    _jsp_string26 = "';\r\n	    }\r\n		$(obj).html(a);\r\n	}\r\n	\r\n	/**\r\n	 * \u8bbe\u7f6e\u67d0\u4e9b\u8282\u70b9\u96c6\u5408\u662f\u5426\u663e\u793acheckbox\r\n	 */\r\n	function setIsExistsCheckbox(treeObj, nodes, flag) {\r\n		if (nodes != undefined && nodes != null) {\r\n			for (var i=0; i<nodes.length; i++) {\r\n				if (nodes[i].nocheck == flag) {\r\n					continue;\r\n				}\r\n				\r\n				nodes[i].nocheck = flag;\r\n				treeObj.updateNode(nodes[i]);\r\n			}\r\n		}\r\n	}\r\n	\r\n	//\u83b7\u53d6\u5206\u90e8\u3001\u90e8\u95e8\u591a\u9009\u7ed3\u679c\r\n	function getMultiResult(){\r\n		var treeObj = $.fn.zTree.getZTreeObj(\"ztreedeep\");\r\n		if(browserType==\"subcompanyMuti\")\r\n		   appendimg=\"Home\";\r\n	    var idstr = \"\";\r\n	    var namestr = \"\";\r\n	    \r\n		var nodes = treeObj.getCheckedNodes(true);\r\n		\r\n		if (nodes == undefined || nodes == \"\" || nodes.length < 1) {\r\n			return \"\";\r\n		}\r\n		\r\n		var agceVal = \"\"; \r\n		for (var i=0; i<nodes.length; i++) {\r\n			//\u5f00\u542f\u5168\u9009 && \u662f\u4e00\u4e2a\u7236\u5143\u7d20 && \u88ab\u9009\u4e2d\r\n			if (selectallflag && nodes[i].isParent && nodes[i].checked) {\r\n				//\u5b50\u8282\u70b9\r\n				var childNodes = nodes[i].childs;\r\n				//\u5b50\u8282\u70b9\u4e3a\u7a7a\uff0c\u8bf4\u660e\u5b50\u8282\u70b9\u8fd8\u672aajax\u52a0\u8f7d\r\n				if (childNodes == undefined) {\r\n					if (nodes[i].icon.indexOf(appendimg) != -1) {\r\n						agceVal += ajaxGetChildEleValue(nodes[i].value, \"dep\");\r\n					} else {\r\n						agceVal += ajaxGetChildEleValue(nodes[i].value, \"com\");\r\n					}\r\n				}\r\n			}\r\n\r\n			if (nodes[i].icon.indexOf(appendimg) != -1) {\r\n				idstr += \",\" + nodes[i].value;\r\n				namestr += \",\" + nodes[i].name;\r\n			}\r\n		}\r\n		\r\n		var agceValArray = agceVal.split(\",\");\r\n		var agceArray = null;\r\n		var agceId = \"\";\r\n		var agceName = \"\";\r\n		for (var i=0; i<agceValArray.length; i++) {\r\n			agceArray = agceValArray[i].split(\"_\");\r\n			\r\n			if (agceArray != null && agceArray != undefined && agceArray.length > 2) {\r\n				agceId += \",\";\r\n				agceId += agceArray[agceArray.length - 2];\r\n				agceName += \",\";\r\n				agceName += agceArray[agceArray.length - 1];\r\n			}\r\n		}\r\n		idstr += agceId;\r\n		namestr += agceName;\r\n		\r\n		if(idstr.length>0)\r\n		   idstr=idstr.substr(1);\r\n		   \r\n		if(namestr.length>0)\r\n		   namestr=namestr.substr(1);\r\n		\r\n		resultStr = idstr + \"$\" + namestr;\r\n	    return resultStr;\r\n	}\r\n	\r\n	//\u83b7\u5f97\u5206\u90e8\u3001\u90e8\u95e8\u5355\u9009\u9009\u62e9\u7ed3\u679c\r\n	function getSingleResult(){\r\n	\r\n	    var nameStr=\"\";\r\n	    var idStr = \"\";\r\n	    var treeObj = $.fn.zTree.getZTreeObj(\"ztreedeep\");\r\n		var nodes = treeObj.getCheckedNodes(true);\r\n		\r\n		if (nodes == undefined || nodes == \"\" || nodes.length < 1) {\r\n			return \"\";\r\n		}\r\n		\r\n		for (var i=0; i<nodes.length; i++) {\r\n			nameStr = nodes[i].nodeid;\r\n			idStr = nodes[i].name;\r\n		}\r\n		var arraytemp = nameStr.split(\"_\");\r\n	\r\n	    var resultStr = \"0\";\r\n	    if(arraytemp.length > 1) {\r\n	    	resultStr = arraytemp[1];;\r\n	    }else if(arraytemp.length > 2) {\r\n	    	resultStr = arraytemp[2];;\r\n	    }\r\n	\r\n		var strtmp2 = \"\";\r\n		for(var i=0;i<arraytemp.length;i++){\r\n			if(i>2){\r\n				strtmp2 = strtmp2 + \"_\" + arraytemp[i];\r\n			}\r\n		}\r\n		resultStr = resultStr + \"$\" + idStr;\r\n	    return resultStr;\r\n	\r\n	}\r\n	\r\n	function ajaxGetChildEleValue(subId, suptype){\r\n    	var ajaxvalue = \"\";\r\n		$.ajax({\r\n			type : \"get\",\r\n			url : \"/mobile/plugin/browser/BrowserOperation.jsp?operation=getHrmOrgChildren&subId=\" + subId + \"&suptype=\" + suptype,\r\n			async : false,\r\n			success : function(data){\r\n				ajaxvalue = $.trim(data);\r\n			}\r\n		});\r\n		\r\n		if (ajaxvalue == undefined && ajaxvalue == null ) {\r\n			ajaxvalue = \"\";\r\n		}\r\n		return ajaxvalue;\r\n    }\r\n	//-->\r\n	</SCRIPT>\r\n".toCharArray();
    _jsp_string9 = "\">\r\n    <table   width=100% height=100% border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"margin: 0px;padding: 0px;\">\r\n        <colgroup>\r\n        <col width=\"10\">\r\n        <col width=\"\">\r\n        <col width=\"10\">\r\n        <tr>\r\n            <td ></td>\r\n            <td valign=\"top\">\r\n                <TABLE  class=Shadow width=\"100%\">\r\n                    <tr>\r\n                        <td valign=\"top\">\r\n                                <TABLE ID=BrowseTable class=\"BroswerStyle\"  cellspacing=\"1\" STYLE=\"margin-top:0\" width=\"100%\">\r\n                                      <TR>\r\n                                          <TD colspan=\"4\" WIDTH=\"100%\">\r\n	                                            <div id=\"deeptree\" style=\"height:".toCharArray();
    _jsp_string21 = "\";\r\n		cxtree_ids = cxtree_id.split(',');\r\n		cxtree_id = cxtree_ids[0];\r\n	} \r\n	\r\n	/**\r\n	 * \u83b7\u53d6url\uff08alax\u65b9\u5f0f\u83b7\u5f97\u5b50\u8282\u70b9\u65f6\u4f7f\u7528\uff09\r\n	 */\r\n	function getAsyncUrl(treeId, treeNode) {\r\n		//\u83b7\u53d6\u5b50\u8282\u70b9\u65f6\r\n	    if (treeNode != undefined && treeNode.isParent != undefined && treeNode.isParent != null) {\r\n	    	return \"/mobile/plugin/browser/HrmOrgTreeData.jsp?\" + treeNode.ajaxParam + \"&\" + new Date().getTime() + \"=\" + new Date().getTime();\r\n	    } else {\r\n	    	//\u521d\u59cb\u5316\u65f6\r\n	    	return \"/mobile/plugin/browser/HrmOrgTreeData.jsp?deptlevel=".toCharArray();
    _jsp_string0 = "\r\n \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n".toCharArray();
    _jsp_string18 = "\";  //\u6d4f\u89c8\u6846\u7c7b\u578b  \u591a\u9009  \u5355\u9009\r\n	var selectallflag=false;             //\u662f\u5426\u5f00\u542f\u5168\u9009\r\n	var appendimg = 'subCopany_Colse';\r\n	var appendname = 'selObj';\r\n	var allselect = 'all';\r\n	var selectedids = \"".toCharArray();
    _jsp_string20 = "\";\r\n	}\r\n	\r\n	var cxtree_ids;\r\n	if(selectedids!=\"0\"&&selectedids!=\"\"){\r\n		cxtree_id = \"".toCharArray();
    _jsp_string22 = "&excludeid=".toCharArray();
    _jsp_string5 = "\">\r\n    <input class=inputstyle type=hidden name=id value=\"".toCharArray();
    _jsp_string6 = "\">\r\n    <input class=inputstyle type=hidden name=level value=\"".toCharArray();
    _jsp_string3 = "\r\n<HTML>\r\n<HEAD>\r\n	<script type=\"text/javascript\" src=\"/mobile/plugin/browser/js/zTree/js/jquery-1.4.4.min_wev8.js\"></script>\r\n	<link rel=\"stylesheet\" href=\"/mobile/plugin/browser/js/zTree/css/zTreeStyle/zTreeStyle_wev8.css\" type=\"text/css\">\r\n	<script type=\"text/javascript\" src=\"/mobile/plugin/browser/js/zTree/js/jquery.ztree.core.min_wev8.js\"></script>\r\n	<script type=\"text/javascript\" src=\"/mobile/plugin/browser/js/zTree/js/jquery.ztree.excheck.min_wev8.js\"></script>\r\n	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\r\n</HEAD>\r\n".toCharArray();
    _jsp_string11 = "\r\n	                                       <tr style=\"height:10px\"> <td height=\"0\" colspan=\"3\"></td></tr>\r\n									       <tr>\r\n										        <td align=\"center\" valign=\"bottom\" colspan=3>\r\n													<BUTTON type=\"button\" class=btn accessKey=O  id=btnok onclick=\"onSave()\"><u>O</u>-".toCharArray();
    _jsp_string4 = "\r\n\r\n<!-- onload=\"initTree()\" --> \r\n<BODY scroll=\"no\" style=\"padding: 0px;margin: 0px;\">\r\n <FORM NAME=select STYLE=\"margin-bottom:0\" action=\"/mobile/plugin/browser/DepartmentBrowser.jsp\" method=post>\r\n    <input class=inputstyle type=hidden name=type value=\"".toCharArray();
    _jsp_string2 = "\r\n\r\n\r\n\r\n\r\n".toCharArray();
    _jsp_string1 = "\r\n".toCharArray();
    _jsp_string12 = "</BUTTON>\r\n													<BUTTON type=\"button\" class=btn accessKey=2  id=btnclear onclick=\"onClear()\"><u>2</u>-".toCharArray();
    _jsp_string19 = "\";\r\n	var cxtree_id = \"\";\r\n	if(selectedids!=\"0\" && selectedids!=\"\"){\r\n		cxtree_id = \"dept_".toCharArray();
    _jsp_string17 = "\r\n                                </TABLE>\r\n                         </td>\r\n                    </tr>\r\n                </TABLE>\r\n            </td>\r\n            <td></td>\r\n        </tr>\r\n    </table>\r\n  </FORM>  \r\n</BODY>\r\n</HTML>\r\n\r\n<script type=\"text/javascript\">\r\n	//<!--\r\n	var browserType=\"".toCharArray();
    _jsp_string14 = "</BUTTON>\r\n											        ".toCharArray();
    _jsp_string15 = "\r\n											        <BUTTON type=\"button\" class=btnReset accessKey=T  id=btncancel onclick=\"needSelectAll(!selectallflag,this)\">\u5f00\u542f\u5168\u9009</BUTTON>\r\n										            ".toCharArray();
  }
}
